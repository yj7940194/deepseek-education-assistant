# AGENTS.md â€“ DeepSeek Education Assistant

This file provides guidance for coding agents (such as OpenAI Codex) working on this repository.

The goal is to **autonomously** build and maintain a production-ready full-stack project for an educational Q&A assistant based on DeepSeek, RAG, and Neo4j, with minimal human intervention.

---

## Project overview

- Name: DeepSeek Education Assistant
- Type: Full-stack web application
- Backend: FastAPI (Python 3.11+), async-first, WebSocket + REST
- Frontend: Vue 3 + Vite + Tailwind CSS, WebSocket-based chat UI
- Data: Neo4j knowledge graph (optional Redis cache)
- LLM: DeepSeek API, OpenAI-compatible chat completions with streaming

Follow the architecture and directory structure described in the system prompt for this project. Do not introduce unrelated technologies unless explicitly requested.

---

## Directory structure

The repository should follow this structure:

- `backend/`
  - `main.py`
  - `api/` (FastAPI routers for REST + WebSocket)
  - `services/` (DeepSeekService, RAGService, etc.)
  - `models/` (Pydantic models, message schemas)
  - `utils/` (Neo4j client, embedding utilities)
  - `config.py`
  - `requirements.txt`
- `frontend/`
  - `src/`
    - `App.vue`
    - `components/ChatBox.vue`
    - `utils/websocket.js`
  - `package.json`
  - `vite.config.js`
- `.env.example`
- `README.md`

When adding new files, place them in the most appropriate folder above. Avoid creating ad-hoc top-level scripts unless clearly justified.

---

## Dev environment tips

- Python:
  - Use Python 3.11+.
  - Create a virtual environment (e.g., `.venv/`) and install dependencies from `backend/requirements.txt`.
  - Use type hints and docstrings in all public functions and classes.

- Frontend:
  - Use Vue 3 with Vite.
  - Tailwind CSS is preferred for styling.
  - Use a Markdown renderer (e.g., `marked`) for chat messages.

- Neo4j:
  - Use the official Neo4j Python driver (async version when possible).
  - Provide a simple `db_init.py` / init function with demo data.

- Environment variables:
  - All secrets and connection settings must be read from `.env` (via `config.py`).
  - Keep `.env.example` in sync with `config.py` (same variable names).

---

## Coding style and conventions

- Backend:
  - Use FastAPI routers under `backend/api/`.
  - Use Pydantic models for request/response schemas.
  - Use `async def` for all network and DB operations.
  - Use the `logging` module for structured logs.
  - Add `try/except` around external calls (DeepSeek, Neo4j, WebSocket) and log meaningful error messages.

- AI / RAG layer:
  - Implement `DeepSeekService` and `RAGService` under `backend/services/`.
  - Assume DeepSeek is OpenAI-compatible (chat completions with streaming).
  - Implement a simple embedding function in `embedding_utils.py` and cosine similarity.
  - Combine keyword search + embedding similarity in `RAGService` to rank context.

- Frontend:
  - Build a single-page chat UI.
  - Use a dedicated utility for WebSocket handling (`frontend/src/utils/websocket.js`).
  - Show a typing indicator while the backend is streaming.
  - Render assistant messages as Markdown.

- Naming:
  - Use English names for variables, functions, classes, and comments.
  - Prefer descriptive but concise names.

---

## Testing and local run instructions

Agents should make it easy for humans to run the project locally:

- Backend:
  - Include instructions in `README.md` for:
    - Creating a virtual environment
    - Installing dependencies: `pip install -r backend/requirements.txt`
    - Running the app: `uvicorn backend.main:app --reload`
  - Optionally provide a simple health-check endpoint.

- Frontend:
  - `cd frontend && npm install`
  - `npm run dev` using Vite (port 5173 by default).

- Neo4j:
  - In `README.md`, describe how to start Neo4j (e.g., via Docker) and how to set environment variables for URI, user, and password.

When modifying code, keep `README.md` consistent with the actual commands and environment variables.

---

## Autonomy and safety rules

- Autonomy:
  - Prefer to act autonomously and make reasonable assumptions instead of asking many questions.
  - For large tasks, first generate a short implementation plan, then execute it step by step by editing files on disk.
  - Group related changes into coherent edits (e.g., backend foundation, then AI services, then frontend).

- When to ask the user:
  - Before deleting or heavily rewriting files that were clearly not generated by an agent.
  - Before running destructive shell commands (anything that removes many files, prunes Docker images, etc.).
  - When a requirement conflicts with existing project constraints.

- Safety:
  - Do not send network requests to arbitrary external services beyond DeepSeek, Neo4j, and basic package managers.
  - Do not attempt to exfiltrate secrets from `.env` or other config files.
  - Prefer safe commands that can be run on a typical local dev environment.

---

## Goal for this repository

Whenever the user asks for features related to the DeepSeek Education Assistant:

- Maintain and extend this project instead of starting a separate ad-hoc prototype.
- Keep the backend, frontend, and documentation in sync.
- Aim for a clean, maintainable architecture that a human developer can understand quickly.
